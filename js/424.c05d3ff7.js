"use strict";(self["webpackChunkmall_mogujie"]=self["webpackChunkmall_mogujie"]||[]).push([[424],{6262:function(t,s,e){e.r(s),e.d(s,{default:function(){return $t}});var i=function(){var t=this,s=t._self._c;return s("div",{attrs:{id:"detail"}},[s("DetailNavbar",{ref:"navbar",on:{"click-navbar":t.clickNavTitle}}),s("scroll",{ref:"scroll",staticClass:"bscroll-container",style:"height: calc(100% -  3.2rem);",attrs:{"probe-type":3,"scroll-listen":t.scroller,"scroll-end":t.scrollEnd}},[s("DetailSwiper",{attrs:{"top-images":t.topImages}}),s("DeatilBaseInfo",{attrs:{goods:t.goods}}),s("DetailSku",{attrs:{"sku-props":t.skuInfo.props,expressage:t.itemInfo.extra}}),s("DeailShop",{attrs:{"shop-info":t.shopInfo}}),s("DetailInfo",{attrs:{"detail-info":t.detailInfo}}),s("DetailParams",{ref:"params",attrs:{"params-info":t.itemParams}}),s("DeatilComment",{ref:"comment",attrs:{comment:t.comment}}),s("DetailRecommend",{ref:"recommend",attrs:{"goods-list":t.recommends}})],1),s("back-top",{directives:[{name:"show",rawName:"v-show",value:t.backTopShow,expression:"backTopShow"}],nativeOn:{click:function(s){return t.scrollBackTopByBscroll.apply(null,arguments)}}}),s("DetailBottomBar",{on:{"add-cart":t.addCart}}),s("Modal",{attrs:{show:t.showModal,title:"提示"},on:{hideModal:t.hideModal,submit:t.submit}},[s("div",[t._v("是否加入购物车")])])],1)},a=[],o=(e(7658),e(4493)),n=e(8301),r=e(7707);function l(t){return(0,r.d)({method:"GET",url:"/detail",params:{iid:t}})}function c(){return(0,r.d)({method:"GET",url:"/recommend"})}class d{constructor(t,s,e){this.title=t.title,this.desc=t.desc,this.lowNowPrice=t.lowNowPrice,this.lowPrice=t.lowPrice,this.oldPrice=t.oldPrice,this.highPrice=t.highPrice,this.highNowPrice=t.highNowPrice,this.price=t.price,this.discountDesc=t.discountDesc,this.discountBgColor=t.discountBgColor,this.columns=s,this.services=e}}class p{constructor(t){this.name=t.name,this.score=t.score,this.logo=t.shopLogo,this.shopUrl=t.shopUrl,this.cFans=t.cFans,this.cGoods=t.cGoods,this.cSells=t.cSells}}var u=function(){var t=this,s=t._self._c;return s("div",{staticClass:"detail-navbar"},[s("nav-bar",{staticClass:"detail-navbar-box"},[s("div",{staticClass:"back",attrs:{slot:"left"},on:{click:t.backLast},slot:"left"},[s("img",{attrs:{src:e(228),alt:""}})]),s("div",{staticClass:"title",attrs:{slot:"center"},slot:"center"},t._l(t.titles,(function(e,i){return s("span",{class:{active:i===t.currentIndex},on:{click:function(s){return t.clickNavTitle(i)}}},[t._v(t._s(e))])})),0)])],1)},m=[],h=e(8641),f={name:"DetailNavbar",components:{NavBar:h.Z},data(){return{titles:["商品","参数","评论","推荐"],currentIndex:0}},methods:{clickNavTitle(t){this.currentIndex=t,this.$emit("click-navbar",t)},backLast(){this.$router.back()}}},v=f,_=e(3736),g=(0,_.Z)(v,u,m,!1,null,"46a0c289",null),I=g.exports,C=function(){var t=this,s=t._self._c;return s("div",[s("swiper",{staticClass:"swiper",attrs:{options:t.swiperOption}},[t._l(t.topImages,(function(t,e){return s("swiper-slide",{key:e},[s("img",{staticClass:"top-image",attrs:{src:t}})])})),s("div",{staticClass:"swiper-pagination",attrs:{slot:"pagination"},slot:"pagination"})],2)],1)},k=[],b=e(551),w={name:"DetailSwiper",components:{Swiper:b.Swiper,SwiperSlide:b.SwiperSlide},props:{topImages:{type:Array}},data(){return{swiperOption:{pagination:{el:".swiper-pagination",clickable:!0},autoplay:{delay:3e3},loop:!0}}}},x=w,y=(0,_.Z)(x,C,k,!1,null,"76df4a60",null),D=y.exports,P=function(){var t=this,s=t._self._c;return s("div",{staticClass:"goods-base-info"},[s("div",{staticClass:"title"},[s("h3",[t._v(t._s(t.goods.title))])]),s("div",{staticClass:"price"},[s("span",{staticClass:"low-price"},[t._v(t._s(t.goods.price))]),s("span",{staticClass:"high-price"},[t._v("¥"+t._s(t.goods.highPrice))]),t.goods.discountDesc?s("span",{staticClass:"discount"},[t._v(t._s(t.goods.discountDesc))]):t._e()]),s("div",{staticClass:"extra"},t._l(t.goods.columns,(function(e){return s("span",[t._v(t._s(e))])})),0),s("div",{staticClass:"services"},t._l(t.goods.services,(function(e){return s("div",{staticClass:"services-item"},[s("img",{attrs:{src:e.icon,alt:""}}),s("span",[t._v(t._s(e.name))])])})),0)])},S=[],$={name:"DetailBaseInfo",props:{goods:{type:Object,default(){return{}}}}},N=$,B=(0,_.Z)(N,P,S,!1,null,"2c3be307",null),T=B.exports,M=function(){var t=this,s=t._self._c;return s("div",{staticClass:"shop-info"},[s("header",[s("img",{attrs:{src:t.shopInfo.logo,alt:""}}),s("span",[t._v(t._s(t.shopInfo.name))])]),s("main",{staticClass:"shop-middle"},[s("div",{staticClass:"left"},[s("div",{staticClass:"totalSell"},[s("p",[t._v(t._s(t.shopInfo.cSells>1e4?parseInt(t.shopInfo.cSells/1e4)+"万":t.shopInfo.cSells))]),s("p",[t._v("总销量")])]),s("div",{staticClass:"totalGoods"},[s("p",[t._v(t._s(t.shopInfo.cGoods))]),s("p",[t._v("全部宝贝")])])]),s("div",{staticClass:"right"},[s("ul",t._l(t.shopInfo.score,(function(e){return s("li",[s("span",{staticStyle:{flex:"3"}},[t._v(t._s(e.name))]),s("span",{staticStyle:{flex:"2"},style:{color:e.score>=4.8?t.red:t.green}},[t._v(t._s(e.score))]),s("span",{staticStyle:{flex:"1",color:"white","border-radius":"2px","text-align":"center",padding:"0 1px"},style:{"background-color":e.isBetter?t.red:t.green}},[t._v(t._s(e.isBetter?"高":"低"))])])})),0)])]),t._m(0)])},Z=[function(){var t=this,s=t._self._c;return s("footer",[s("div",[t._v("进店逛逛")])])}],j={name:"DetailShop",data(){return{red:"#FF3333",green:"#33CC4D"}},props:{shopInfo:{type:Object,default(){return{}}}}},L=j,O=(0,_.Z)(L,M,Z,!1,null,"764ee8dc",null),z=O.exports,A=function(){var t=this,s=t._self._c;return s("div",{staticClass:"detail-sku"},[s("div",{staticClass:"sku-info"},[s("div",[t._v("选择")]),s("div",[t._v(t._s(t.skuInfo)+" "+t._s(t.reamark))])]),t.expressage&&t.expressage.sendAddress?s("div",{staticClass:"express-info"},[s("div",[t._v("发货")]),s("div",[t._v(t._s(t.expressInfo))])]):t._e()])},G=[],E={name:"DetailSku",props:{skuProps:{type:Array,default(){return null}},expressage:{type:Object,default(){return null}}},computed:{skuInfo(){return this.skuProps?this.skuProps.map((t=>t.label.replace(":",""))).join(" / "):""},reamark(){if(this.skuProps){let t=this.skuProps[0].label.replace(":",""),s=this.skuProps[0].list.length;return`（共${s}种${t}可选）`}return""},expressInfo(){return this.expressage?`${this.expressage.sendAddress} （${this.expressage.deliveryTime}小时内发货）`:""}}},Y=E,F=(0,_.Z)(Y,A,G,!1,null,"109cf368",null),R=F.exports,V=e(4337),K=function(){var t=this,s=t._self._c;return s("div",{staticClass:"detail-info"},[s("header",[s("div",{staticClass:"top"}),s("div",{staticClass:"desc"},[t._v(t._s(t.detailInfo.desc))]),s("div",{staticClass:"bottom"})]),s("main",t._l(t.detailInfo.detailImage,(function(e){return s("div",[s("div",{staticClass:"info-key"},[t._v(t._s(e.key))]),s("section",t._l(e.list,(function(i,a){return e.list?s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:i,expression:"img"}],staticClass:"detail-info-img",attrs:{alt:""},on:{load:function(s){return t.detailImgsLoad(a,t.totalImgSize)}}}):t._e()})),0)])})),0)])},U=[],q={name:"DetailInfo",props:{detailInfo:{type:Object,default(){return{}}}},data(){return{num:0}},computed:{totalImgSize(){let t=this.detailInfo.detailImage.map((t=>t.list)).filter((t=>void 0!==t)).flatMap((t=>t));return t.length}},methods:{detailImgsLoad(t,s){let e=this.num+=1;e>=s&&(console.log("send",n.Vn),this.$bus.$emit(n.Vn))}}},H=q,J=(0,_.Z)(H,K,U,!1,null,"3fea63e9",null),Q=J.exports,W=function(){var t=this,s=t._self._c;return s("div",{staticClass:"detail-params"},[t.paramsInfo&&t.paramsInfo.rule?s("div",{staticClass:"size_info"},[s("div",{staticClass:"infoKey"},[t._v(t._s(t.paramsInfo.rule.key))]),s("ul",t._l(t.sizeMap.keys(),(function(e,i){return s("li",{key:i},[s("span",[t._v(t._s(e))]),t._l(t.sizeMap.get(e),(function(e,i){return s("span",{key:i},[t._v(t._s(e))])}))],2)})),0),t.paramsInfo.rule.disclaimer?s("div",{staticClass:"info-remark"},[t._v(t._s(t.paramsInfo.rule.disclaimer))]):t._e()]):t._e(),t.paramsInfo&&t.paramsInfo.info?s("div",{staticClass:"product_info"},[s("div",{staticClass:"infoKey"},[t._v(t._s(t.paramsInfo.info.key))]),s("ul",t._l(t.productInfo,(function(e,i){return s("li",{key:i},[s("span",[t._v(t._s(e.key))]),s("span",[t._v(t._s(e.value))])])})),0)]):t._e()])},X=[],tt={name:"DetailParams",props:{paramsInfo:{type:Object,default(){return null}}},computed:{productInfo(){return this.paramsInfo.info.set},sizeMap(){let t=new Map;return this.paramsInfo.rule.tables&&this.paramsInfo.rule.tables.forEach((s=>{s.forEach((s=>{let e=s[0],i=Array.from(s).slice(1);if(t.has(e)){let s=t.get(e).concat(i);t.set(e,s)}else t.set(e,i)}))})),t}}},st=tt,et=(0,_.Z)(st,W,X,!1,null,"3aaa3a88",null),it=et.exports,at=function(){var t=this,s=t._self._c;return s("div",{staticClass:"detail-comment"},[s("header",[s("div",[t._v("用户评论"+t._s(t.comment?"(99)":"(0)"))]),s("div",[t._v("更多")])]),t.comment?s("main",[s("div",{staticClass:"comment-user"},[s("img",{attrs:{src:t.user.avatar,alt:""}}),s("span",[t._v(t._s(t.user.uname))])]),s("div",{staticClass:"comment-text"},[s("p",[t._v(t._s(t.comment.content))])]),t.comment.images?s("div",{staticClass:"comment-img"},t._l(t.comment.images,(function(t){return s("img",{attrs:{src:t,alt:""}})})),0):t._e(),s("div",{staticClass:"comment-sku"},[s("span",[t._v(t._s(t._f("formatDate")(t.comment.created)))]),s("span",[t._v(" "+t._s(t.comment.style))])])]):t._e()])},ot=[],nt={name:"DetailComment",props:{comment:{}},computed:{user(){return this.comment?this.comment.user:null}},filters:{formatDate(t){var s=new Date(1e3*t),e=[s.getFullYear(),s.getMonth()+1,s.getDate()].join("-");return e}}},rt=nt,lt=(0,_.Z)(rt,at,ot,!1,null,"e2d2b9a6",null),ct=lt.exports,dt=function(){var t=this,s=t._self._c;return s("div",{staticClass:"detail-recommend"},[s("div",{staticClass:"title"},[t._v("更多推荐")]),s("goods-list",{staticClass:"detail-goods-list",attrs:{goodsList:t.goodsList}})],1)},pt=[],ut=e(4570),mt={name:"DetailReconmmend",components:{GoodsList:ut.Z},props:{goodsList:[]}},ht=mt,ft=(0,_.Z)(ht,dt,pt,!1,null,"283d75aa",null),vt=ft.exports,_t=e(145),gt=function(){var t=this,s=t._self._c;return s("div",{staticClass:"detail-bottom-bar"},[t._m(0),s("div",{staticClass:"right"},[s("div",[s("span",{staticClass:"cart-button",on:{click:t.addCart}},[t._v("加入购物车")])]),s("div",[s("span",{staticClass:"buy-button",on:{click:t.buy}},[t._v("立即购买")])])])])},It=[function(){var t=this,s=t._self._c;return s("div",{staticClass:"left"},[s("div",[s("i",{staticClass:"iconfont icon-shop"}),s("span",{staticClass:"text"},[t._v("店铺")])]),s("div",[s("i",{staticClass:"iconfont icon-service",staticStyle:{color:"burlywood"}}),s("span",{staticClass:"text"},[t._v("客服")])]),s("div",[s("i",{staticClass:"iconfont icon-favor"}),s("span",{staticClass:"text"},[t._v("收藏")])])])}],Ct={name:"DetailBottomBar",methods:{addCart(){this.$emit("add-cart")},buy(){this.$toast.show("暂未实现")}}},kt=Ct,bt=(0,_.Z)(kt,gt,It,!1,null,"2c51b71a",null),wt=bt.exports,xt=e(8762),yt=e(3822),Dt={name:"Detail",data(){return{itemInfo:{},topImages:[],goods:{},shopInfo:{},skuInfo:{},detailInfo:{},itemParams:{},comment:null,recommends:[],tmpY:0,setNavPosition:null,navPosition:[],navIndex:0,showModal:!1}},mixins:[_t.$y,_t.s6,_t.Ic],components:{DetailNavbar:I,DetailSwiper:D,DeatilBaseInfo:T,DeailShop:z,DetailInfo:Q,Scroll:V.Z,DetailParams:it,DetailSku:R,DeatilComment:ct,DetailRecommend:vt,DetailBottomBar:wt},computed:{iid(){return this.$route.params.iid}},created(){l(this.iid).then((t=>{let s=t.result;this.goods=new d(s.itemInfo,s.columns,s.shopInfo.services),this.itemInfo=s.itemInfo,this.topImages=s.itemInfo.topImages,this.shopInfo=new p(s.shopInfo),this.skuInfo=s.skuInfo,this.detailInfo=s.detailInfo,this.itemParams=s.itemParams,this.comment=s.rate.list?s.rate.list[0]:null})),c().then((t=>{this.recommends=t.data.list}))},mounted(){this.setNavPosition=(0,o.D)((()=>{this.navPosition=[],this.navPosition.push(0),this.navPosition.push(this.$refs.params.$el.offsetTop),this.navPosition.push(this.$refs.comment.$el.offsetTop),this.navPosition.push(this.$refs.recommend.$el.offsetTop)}),500),this.$bus.$on(n.Vn,(()=>{this.setNavPosition()}))},methods:{scroller(t){this.tmpY=-parseInt(t.y),this.judgeBackTopShow(this.tmpY,1e3)},scrollEnd(){let t=-parseInt(this.$refs.scroll.getY()),s=this.navPosition.length;for(let e=0;e<s;e++){let i=this.navPosition[e]-44<0?0:this.navPosition[e];this.navIndex!=e&&(e<s-1&&t>=i&&t<this.navPosition[e+1]-44||e==s-1&&t>=i)&&(this.navIndex=e,this.$refs.navbar.currentIndex=this.navIndex)}},clickNavTitle(t){this.navIndex=t,this.$refs.scroll.scrollTo(0,44-this.navPosition[t])},...(0,yt.OI)([xt.yf]),...(0,yt.nv)([xt.fc]),addCart(){this.showModal=!0},hideModal(){this.showModal=!1},submit(){const t={};t.image=this.topImages[0],t.iid=this.iid,t.title=this.goods.title,t.desc=this.goods.desc,t.price=this.goods.lowPrice,t.realPrice=this.goods.lowNowPrice,t.num=1,t.checked=!1,this.ADD_CART_ASYNC(t).then((()=>{this.$toast.show("加入购物车成功！")})).catch((t=>{console.error(t)})),this.showModal=!1}}},Pt=Dt,St=(0,_.Z)(Pt,i,a,!1,null,"487272b1",null),$t=St.exports},228:function(t,s,e){t.exports=e.p+"img/back.2905f178.svg"}}]);
//# sourceMappingURL=424.c05d3ff7.js.map